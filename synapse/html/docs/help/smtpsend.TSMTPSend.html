<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.1 Strict//EN" "http://www.w3.org/TR/REC-html4/strict.dtd">
<html>
<head>
<meta name="GENERATOR" content="PasDoc 0.8.8.2"/>
<title>smtpsend: Class TSMTPSend</title>
<link rel="StyleSheet" href="pasdoc.css"/>
</head>
<body bgcolor="#ffffff" text="#000000" link="#0000ff" vlink="#800080" alink="#FF0000">
<a name="TSMTPSend"></a><h1>Class TSMTPSend</h1>
<table class="sections"><tr>
<td><a class="section" href="#@Description">Description</a></td><td><a class="section" href="#@Hierarchy">Hierarchy</a></td><td>Fields</td><td><a class="section" href="#@Methods">Methods</a></td><td><a class="section" href="#@Properties">Properties</a></td></tr></table>
<a name="@Description"></a><h2>Unit</h2>
<a class="bold" href="smtpsend.html">smtpsend</a><br/><h2>Declaration</h2>
<p><code>type TSMTPSend = class(<a class="normal" href="blcksock.TSynaClient.html">TSynaClient</a>)</code></p>
<h2>Description</h2>
Implementation of SMTP and ESMTP procotol<p>,
   include some ESMTP extensions, include SSL/TLS too.</p><p>Note: Are you missing properties for setting Username and Password for ESMTP?
   Look to parent <a class="normal" href="blcksock.TSynaClient.html">TSynaClient</a> object!</p><p>Are you missing properties for specify server address and port? Look to
   parent <a class="normal" href="blcksock.TSynaClient.html">TSynaClient</a> too!</p>
<a name="@Hierarchy"></a><h2>Hierarchy</h2>
TSMTPSend&nbsp;&gt; <a class="normal" href="blcksock.TSynaClient.html">TSynaClient</a>&nbsp;&gt; TObject<a name="@Methods"></a><h2>Methods</h2>
<h3>Overview</h3>
<table cellspacing="2" cellpadding="4" width="100%">
<tr class="list" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="public.gif" alt="Public"/></a></td>
<td width="100%"><code>constructor <a class="normal" href="smtpsend.TSMTPSend.html#Create"><b>Create</b></a>;</code></td>
</tr>
<tr class="list2" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="public.gif" alt="Public"/></a></td>
<td><code>destructor <a class="normal" href="smtpsend.TSMTPSend.html#Destroy"><b>Destroy</b></a>; override;</code></td>
</tr>
<tr class="list" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="public.gif" alt="Public"/></a></td>
<td><code>function <a class="normal" href="smtpsend.TSMTPSend.html#EnhCodeString"><b>EnhCodeString</b></a>: string;</code></td>
</tr>
<tr class="list2" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="public.gif" alt="Public"/></a></td>
<td><code>function <a class="normal" href="smtpsend.TSMTPSend.html#Etrn"><b>Etrn</b></a>(const Value: string): Boolean;</code></td>
</tr>
<tr class="list" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="public.gif" alt="Public"/></a></td>
<td><code>function <a class="normal" href="smtpsend.TSMTPSend.html#FindCap"><b>FindCap</b></a>(const Value: string): string;</code></td>
</tr>
<tr class="list2" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="public.gif" alt="Public"/></a></td>
<td><code>function <a class="normal" href="smtpsend.TSMTPSend.html#Login"><b>Login</b></a>: Boolean;</code></td>
</tr>
<tr class="list" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="public.gif" alt="Public"/></a></td>
<td><code>function <a class="normal" href="smtpsend.TSMTPSend.html#Logout"><b>Logout</b></a>: Boolean;</code></td>
</tr>
<tr class="list2" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="public.gif" alt="Public"/></a></td>
<td><code>function <a class="normal" href="smtpsend.TSMTPSend.html#MailData"><b>MailData</b></a>(const Value: Tstrings): Boolean;</code></td>
</tr>
<tr class="list" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="public.gif" alt="Public"/></a></td>
<td><code>function <a class="normal" href="smtpsend.TSMTPSend.html#MailFrom"><b>MailFrom</b></a>(const Value: string; Size: Integer): Boolean;</code></td>
</tr>
<tr class="list2" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="public.gif" alt="Public"/></a></td>
<td><code>function <a class="normal" href="smtpsend.TSMTPSend.html#MailTo"><b>MailTo</b></a>(const Value: string): Boolean;</code></td>
</tr>
<tr class="list" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="public.gif" alt="Public"/></a></td>
<td><code>function <a class="normal" href="smtpsend.TSMTPSend.html#NoOp"><b>NoOp</b></a>: Boolean;</code></td>
</tr>
<tr class="list2" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="public.gif" alt="Public"/></a></td>
<td><code>function <a class="normal" href="smtpsend.TSMTPSend.html#Reset"><b>Reset</b></a>: Boolean;</code></td>
</tr>
<tr class="list" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="public.gif" alt="Public"/></a></td>
<td><code>function <a class="normal" href="smtpsend.TSMTPSend.html#StartTLS"><b>StartTLS</b></a>: Boolean;</code></td>
</tr>
<tr class="list2" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="public.gif" alt="Public"/></a></td>
<td><code>function <a class="normal" href="smtpsend.TSMTPSend.html#Verify"><b>Verify</b></a>(const Value: string): Boolean;</code></td>
</tr>
</table>
<h3>Description</h3>
<table cellspacing="2" cellpadding="4" width="100%">
<tr class="list" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="public.gif" alt="Public"/></a></td>
<td width="100%"><a name="Create"></a><code>constructor <b>Create</b>;</code></td>
</tr>
</table>
<p>&nbsp;</p>
<table cellspacing="2" cellpadding="4" width="100%">
<tr class="list" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="public.gif" alt="Public"/></a></td>
<td width="100%"><a name="Destroy"></a><code>destructor <b>Destroy</b>; override;</code></td>
</tr>
</table>
<p>&nbsp;</p>
<table cellspacing="2" cellpadding="4" width="100%">
<tr class="list" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="public.gif" alt="Public"/></a></td>
<td width="100%"><a name="EnhCodeString"></a><code>function <b>EnhCodeString</b>: string;</code></td>
</tr>
</table>
<p><p>Return string descriptive text for enhanced result codes stored in
     <a class="normal" href="smtpsend.TSMTPSend.html#EnhCode1">EnhCode1</a>, <a class="normal" href="smtpsend.TSMTPSend.html#EnhCode2">EnhCode2</a> and <a class="normal" href="smtpsend.TSMTPSend.html#EnhCode3">EnhCode3</a>.</p>
</p>
<table cellspacing="2" cellpadding="4" width="100%">
<tr class="list" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="public.gif" alt="Public"/></a></td>
<td width="100%"><a name="Etrn"></a><code>function <b>Etrn</b>(const Value: string): Boolean;</code></td>
</tr>
</table>
<p><p>Send ETRN SMTP command for start sending of remote queue for domain in
     Value. If all OK, result is <code>True</code>, else result is <code>False</code>.</p>
</p>
<table cellspacing="2" cellpadding="4" width="100%">
<tr class="list" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="public.gif" alt="Public"/></a></td>
<td width="100%"><a name="FindCap"></a><code>function <b>FindCap</b>(const Value: string): string;</code></td>
</tr>
</table>
<p><p>Try to find specified capability in ESMTP response.</p>
</p>
<table cellspacing="2" cellpadding="4" width="100%">
<tr class="list" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="public.gif" alt="Public"/></a></td>
<td width="100%"><a name="Login"></a><code>function <b>Login</b>: Boolean;</code></td>
</tr>
</table>
<p><p>Connects to SMTP server (defined in <a class="normal" href="blcksock.TSynaClient.html#TargetHost">TargetHost</a>) and
     begin SMTP session. (First try ESMTP EHLO, next old HELO handshake). Parses
     ESMTP capabilites and if you specified Username and password and remote
     server can handle AUTH command, try login by AUTH command. Preffered login
     method is CRAM-MD5 (if safer!). If all OK, result is <code>True</code>, else result is
     <code>False</code>.</p>
</p>
<table cellspacing="2" cellpadding="4" width="100%">
<tr class="list" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="public.gif" alt="Public"/></a></td>
<td width="100%"><a name="Logout"></a><code>function <b>Logout</b>: Boolean;</code></td>
</tr>
</table>
<p><p>Close SMTP session (QUIT command) and disconnect from SMTP server.</p>
</p>
<table cellspacing="2" cellpadding="4" width="100%">
<tr class="list" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="public.gif" alt="Public"/></a></td>
<td width="100%"><a name="MailData"></a><code>function <b>MailData</b>(const Value: Tstrings): Boolean;</code></td>
</tr>
</table>
<p><p>Send DATA SMTP command and transmit message data. If all OK, result is
     <code>True</code>, else result is <code>False</code>.</p>
</p>
<table cellspacing="2" cellpadding="4" width="100%">
<tr class="list" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="public.gif" alt="Public"/></a></td>
<td width="100%"><a name="MailFrom"></a><code>function <b>MailFrom</b>(const Value: string; Size: Integer): Boolean;</code></td>
</tr>
</table>
<p><p>Send MAIL FROM SMTP command for set sender e-mail address. If sender's
     e-mail address is empty string, transmited message is error message.</p><p>If size not 0 and remote server can handle SIZE parameter, append SIZE
     parameter to request. If all OK, result is <code>True</code>, else result is <code>False</code>.</p>
</p>
<table cellspacing="2" cellpadding="4" width="100%">
<tr class="list" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="public.gif" alt="Public"/></a></td>
<td width="100%"><a name="MailTo"></a><code>function <b>MailTo</b>(const Value: string): Boolean;</code></td>
</tr>
</table>
<p><p>Send RCPT TO SMTP command for set receiver e-mail address. It cannot be an
     empty string. If all OK, result is <code>True</code>, else result is <code>False</code>.</p>
</p>
<table cellspacing="2" cellpadding="4" width="100%">
<tr class="list" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="public.gif" alt="Public"/></a></td>
<td width="100%"><a name="NoOp"></a><code>function <b>NoOp</b>: Boolean;</code></td>
</tr>
</table>
<p><p>Send NOOP SMTP command for keep SMTP session. If all OK, result is <code>True</code>,
     else result is <code>False</code>.</p>
</p>
<table cellspacing="2" cellpadding="4" width="100%">
<tr class="list" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="public.gif" alt="Public"/></a></td>
<td width="100%"><a name="Reset"></a><code>function <b>Reset</b>: Boolean;</code></td>
</tr>
</table>
<p><p>Send RSET SMTP command for reset SMTP session. If all OK, result is <code>True</code>,
     else result is <code>False</code>.</p>
</p>
<table cellspacing="2" cellpadding="4" width="100%">
<tr class="list" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="public.gif" alt="Public"/></a></td>
<td width="100%"><a name="StartTLS"></a><code>function <b>StartTLS</b>: Boolean;</code></td>
</tr>
</table>
<p><p>Call STARTTLS command for upgrade connection to SSL/TLS mode.</p>
</p>
<table cellspacing="2" cellpadding="4" width="100%">
<tr class="list" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="public.gif" alt="Public"/></a></td>
<td width="100%"><a name="Verify"></a><code>function <b>Verify</b>(const Value: string): Boolean;</code></td>
</tr>
</table>
<p><p>Send VRFY SMTP command for check receiver e-mail address. It cannot be
     an empty string. If all OK, result is <code>True</code>, else result is <code>False</code>.</p>
</p>
<a name="@Properties"></a><h2>Properties</h2>
<h3>Overview</h3>
<table cellspacing="2" cellpadding="4" width="100%">
<tr class="list" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="published.gif" alt="Published"/></a></td>
<td width="100%"><code>property <a class="normal" href="smtpsend.TSMTPSend.html#AuthDone"><b>AuthDone</b></a>: Boolean;</code></td>
</tr>
<tr class="list2" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="published.gif" alt="Published"/></a></td>
<td><code>property <a class="normal" href="smtpsend.TSMTPSend.html#AutoTLS"><b>AutoTLS</b></a>: Boolean;</code></td>
</tr>
<tr class="list" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="published.gif" alt="Published"/></a></td>
<td><code>property <a class="normal" href="smtpsend.TSMTPSend.html#EnhCode1"><b>EnhCode1</b></a>: Integer;</code></td>
</tr>
<tr class="list2" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="published.gif" alt="Published"/></a></td>
<td><code>property <a class="normal" href="smtpsend.TSMTPSend.html#EnhCode2"><b>EnhCode2</b></a>: Integer;</code></td>
</tr>
<tr class="list" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="published.gif" alt="Published"/></a></td>
<td><code>property <a class="normal" href="smtpsend.TSMTPSend.html#EnhCode3"><b>EnhCode3</b></a>: Integer;</code></td>
</tr>
<tr class="list2" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="published.gif" alt="Published"/></a></td>
<td><code>property <a class="normal" href="smtpsend.TSMTPSend.html#ESMTP"><b>ESMTP</b></a>: Boolean;</code></td>
</tr>
<tr class="list" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="published.gif" alt="Published"/></a></td>
<td><code>property <a class="normal" href="smtpsend.TSMTPSend.html#ESMTPcap"><b>ESMTPcap</b></a>: TStringList;</code></td>
</tr>
<tr class="list2" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="published.gif" alt="Published"/></a></td>
<td><code>property <a class="normal" href="smtpsend.TSMTPSend.html#ESMTPSize"><b>ESMTPSize</b></a>: Boolean;</code></td>
</tr>
<tr class="list" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="published.gif" alt="Published"/></a></td>
<td><code>property <a class="normal" href="smtpsend.TSMTPSend.html#FullResult"><b>FullResult</b></a>: TStringList;</code></td>
</tr>
<tr class="list2" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="published.gif" alt="Published"/></a></td>
<td><code>property <a class="normal" href="smtpsend.TSMTPSend.html#FullSSL"><b>FullSSL</b></a>: Boolean;</code></td>
</tr>
<tr class="list" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="published.gif" alt="Published"/></a></td>
<td><code>property <a class="normal" href="smtpsend.TSMTPSend.html#MaxSize"><b>MaxSize</b></a>: Integer;</code></td>
</tr>
<tr class="list2" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="published.gif" alt="Published"/></a></td>
<td><code>property <a class="normal" href="smtpsend.TSMTPSend.html#ResultCode"><b>ResultCode</b></a>: Integer;</code></td>
</tr>
<tr class="list" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="published.gif" alt="Published"/></a></td>
<td><code>property <a class="normal" href="smtpsend.TSMTPSend.html#ResultString"><b>ResultString</b></a>: string;</code></td>
</tr>
<tr class="list2" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="published.gif" alt="Published"/></a></td>
<td><code>property <a class="normal" href="smtpsend.TSMTPSend.html#Sock"><b>Sock</b></a>: <a class="normal" href="blcksock.TTCPBlockSocket.html">TTCPBlockSocket</a>;</code></td>
</tr>
<tr class="list" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="published.gif" alt="Published"/></a></td>
<td><code>property <a class="normal" href="smtpsend.TSMTPSend.html#SystemName"><b>SystemName</b></a>: string;</code></td>
</tr>
</table>
<h3>Description</h3>
<table cellspacing="2" cellpadding="4" width="100%">
<tr class="list" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="published.gif" alt="Published"/></a></td>
<td width="100%"><a name="AuthDone"></a><code>property <b>AuthDone</b>: Boolean;</code></td>
</tr>
</table>
<p><code>True</code> if you successfuly pass authorisation to remote server.</p>
<table cellspacing="2" cellpadding="4" width="100%">
<tr class="list" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="published.gif" alt="Published"/></a></td>
<td width="100%"><a name="AutoTLS"></a><code>property <b>AutoTLS</b>: Boolean;</code></td>
</tr>
</table>
<p>If is set to true, then upgrade to SSL/TLS mode if remote server support it.</p>
<table cellspacing="2" cellpadding="4" width="100%">
<tr class="list" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="published.gif" alt="Published"/></a></td>
<td width="100%"><a name="EnhCode1"></a><code>property <b>EnhCode1</b>: Integer;</code></td>
</tr>
</table>
<p>First digit of Enhanced result code. If last operation does not have
     enhanced result code, values is 0.</p>
<table cellspacing="2" cellpadding="4" width="100%">
<tr class="list" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="published.gif" alt="Published"/></a></td>
<td width="100%"><a name="EnhCode2"></a><code>property <b>EnhCode2</b>: Integer;</code></td>
</tr>
</table>
<p>Second digit of Enhanced result code. If last operation does not have
     enhanced result code, values is 0.</p>
<table cellspacing="2" cellpadding="4" width="100%">
<tr class="list" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="published.gif" alt="Published"/></a></td>
<td width="100%"><a name="EnhCode3"></a><code>property <b>EnhCode3</b>: Integer;</code></td>
</tr>
</table>
<p>Third digit of Enhanced result code. If last operation does not have
     enhanced result code, values is 0.</p>
<table cellspacing="2" cellpadding="4" width="100%">
<tr class="list" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="published.gif" alt="Published"/></a></td>
<td width="100%"><a name="ESMTP"></a><code>property <b>ESMTP</b>: Boolean;</code></td>
</tr>
</table>
<p><code>True</code> if you successfuly logged to ESMTP server.</p>
<table cellspacing="2" cellpadding="4" width="100%">
<tr class="list" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="published.gif" alt="Published"/></a></td>
<td width="100%"><a name="ESMTPcap"></a><code>property <b>ESMTPcap</b>: TStringList;</code></td>
</tr>
</table>
<p>List of ESMTP capabilites of remote ESMTP server. (If you connect to ESMTP
     server only!).</p>
<table cellspacing="2" cellpadding="4" width="100%">
<tr class="list" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="published.gif" alt="Published"/></a></td>
<td width="100%"><a name="ESMTPSize"></a><code>property <b>ESMTPSize</b>: Boolean;</code></td>
</tr>
</table>
<p><code>True</code> if remote server can handle SIZE parameter.</p>
<table cellspacing="2" cellpadding="4" width="100%">
<tr class="list" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="published.gif" alt="Published"/></a></td>
<td width="100%"><a name="FullResult"></a><code>property <b>FullResult</b>: TStringList;</code></td>
</tr>
</table>
<p>All result strings of last SMTP command (result is maybe multiline!).</p>
<table cellspacing="2" cellpadding="4" width="100%">
<tr class="list" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="published.gif" alt="Published"/></a></td>
<td width="100%"><a name="FullSSL"></a><code>property <b>FullSSL</b>: Boolean;</code></td>
</tr>
</table>
<p>SSL/TLS mode is used from first contact to server. Servers with full
     SSL/TLS mode usualy using non-standard TCP port!</p>
<table cellspacing="2" cellpadding="4" width="100%">
<tr class="list" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="published.gif" alt="Published"/></a></td>
<td width="100%"><a name="MaxSize"></a><code>property <b>MaxSize</b>: Integer;</code></td>
</tr>
</table>
<p>When <a class="normal" href="smtpsend.TSMTPSend.html#ESMTPSize">ESMTPSize</a> is <code>True</code>, contains max length of message that remote
     server can handle.</p>
<table cellspacing="2" cellpadding="4" width="100%">
<tr class="list" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="published.gif" alt="Published"/></a></td>
<td width="100%"><a name="ResultCode"></a><code>property <b>ResultCode</b>: Integer;</code></td>
</tr>
</table>
<p>result code of last SMTP command.</p>
<table cellspacing="2" cellpadding="4" width="100%">
<tr class="list" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="published.gif" alt="Published"/></a></td>
<td width="100%"><a name="ResultString"></a><code>property <b>ResultString</b>: string;</code></td>
</tr>
</table>
<p>result string of last SMTP command (begin with string representation of
     result code).</p>
<table cellspacing="2" cellpadding="4" width="100%">
<tr class="list" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="published.gif" alt="Published"/></a></td>
<td width="100%"><a name="Sock"></a><code>property <b>Sock</b>: <a class="normal" href="blcksock.TTCPBlockSocket.html">TTCPBlockSocket</a>;</code></td>
</tr>
</table>
<p>Socket object used for TCP/IP operation. Good for seting OnStatus hook, etc.</p>
<table cellspacing="2" cellpadding="4" width="100%">
<tr class="list" valign="top"><td><a class="normal" href="legend.html"><img border="0" src="published.gif" alt="Published"/></a></td>
<td width="100%"><a name="SystemName"></a><code>property <b>SystemName</b>: string;</code></td>
</tr>
</table>
<p>name of our system used in HELO and EHLO command. Implicit value is
     internet address of your machine.</p>
<hr noshade="1" size="1"/><em>Generated by <a class="normal" target="_new" href="http://pasdoc.sourceforge.net/">PasDoc 0.8.8.2</a> on 2005-01-19 20:01:19</em>
</body></html>
